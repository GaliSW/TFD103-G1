<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>news</title>
    <link rel="stylesheet" type="text/css" href="../js/vendor/slick-1.8.1/slick/slick-theme.css" />
    <link rel="stylesheet" type="text/css" href="../js/vendor/slick-1.8.1/slick/slick.css" />
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/style.css">
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/fontawesome.min.css"
        integrity="sha384-jLKHWM3JRmfMU0A5x5AkjWkw/EYfGUAGagvnfryNV3F9VqM98XiIH7VBGVoxVSc7" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.6.0/gsap.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://kit.fontawesome.com/8988cd1b75.js" crossorigin="anonymous"></script>

    <script>
        
        window.onload = function doQuery() {
            $.ajax({
                method: "POST",
                url: "../php/news/callnews.php",
                data: {
                },

                dataType: "json",
                success: function (response) {
                    // console.log(response);
                    let date = response[0][1];
                    let title = response[0][2];
                    let content = response[0][3];
                    let img = response[0][4];
                    let block_10 = document.getElementById("block_10");
                    let str =`
                    <div class="left">
                        <p>${date}</p>
                        <h3>${title}</h3>
                        <p>${content}</p>
                        <a href="./news_in.html">
                            <p class="pp">
                                <閱讀更多>
                            </p>
                        </a>
                    </div>
                    <img src="../image/intro/${img}" class="fir1" alt="slide4">
                    `;

                    block_10.innerHTML = str;
                },
                error: function (exception) {
                    alert("發生錯誤: " + exception.status);
                }
            });

            $.ajax({
                method: "POST",
                url: "../php/news/callnews.php",
                data: {
                },
                dataType: "json",
                success: function (response) {
                    // console.log(response);
                    let block_9 = document.getElementById("block_9");
                    //更新html內容(透過jQuery跑迴圈取值)
                    $.each(response, function (index, row) {
                        let str = ` 
                        <div class="sort" onclick="parseCookie(this)" value="${row.ARTICLEID}" >
                            <div class="wrap" >
                                    <img src="../image/intro/${row.AIMG}" class="sec" alt="slide4">
                                <div class="name" >
                                        <p >${row.ADATE}</p>
                                        <h3 class=h3>${row.TITLE}</h3>
                                        <p >${row.CONTENT}</p>
                                        <p class="p">閱讀更多></p>
                                </div>
                            </div>
                        </div>
                    `;
                    block_9.insertAdjacentHTML("beforeend" ,str);
                    });
                },
                error: function (exception) {
                    alert("發生錯誤: " + exception.status);
                }
            });
        }

    </script>

    <script>

function sort2(){
            $.ajax({
                method: "POST",
                url: "../php/news/callnews3.php",
                data: {
                },
                dataType: "json",
                success: function (response) {
                    // console.log(response);
                    let block_9 = document.getElementById("block_9");
                    block_9.innerHTML = ""; 

                    //更新html內容(透過jQuery跑迴圈取值)
                    $.each(response, function (index, row) {
                        let str = ` 
                        <div class="sort" onclick="parseCookie(this)" value="${row.ARTICLEID}" >
                            <div class="wrap" >
                                    <img src="../image/intro/${row.AIMG}" class="sec" alt="slide4">
                                <div class="name" >
                                        <p >${row.ADATE}</p>
                                        <h3 class=h3>${row.TITLE}</h3>
                                        <p >${row.CONTENT}</p>
                                        <p class="p">閱讀更多></p>
                                </div>
                            </div>
                        </div>
                    `;
                    block_9.insertAdjacentHTML("beforeend" ,str);
                    });
                },
                error: function (exception) {
                    alert("發生錯誤: " + exception.status);
                }
            });
        }


        function sort(){
            $.ajax({
                method: "POST",
                url: "../php/news/callnews.php",
                data: {
                },
                dataType: "json",
                success: function (response) {
                    // console.log(response);
                    let block_9 = document.getElementById("block_9");
                    block_9.innerHTML = ""; 

                    //更新html內容(透過jQuery跑迴圈取值)
                    $.each(response, function (index, row) {
                        let str = ` 
                        <div class="sort" onclick="parseCookie(this)" value="${row.ARTICLEID}" >
                            <div class="wrap" >
                                    <img src="../image/intro/${row.AIMG}" class="sec" alt="slide4">
                                <div class="name" >
                                        <p >${row.ADATE}</p>
                                        <h3 class=h3>${row.TITLE}</h3>
                                        <p >${row.CONTENT}</p>
                                        <p class="p">閱讀更多></p>
                                </div>
                            </div>
                        </div>
                    `;
                    block_9.insertAdjacentHTML("beforeend" ,str);
                    });
                },
                error: function (exception) {
                    alert("發生錯誤: " + exception.status);
                }
            });
        }

    </script>

    


</head>

<body>

    <div class="otot"></div>

    @@include('./header.html')
    <div class="out">
        <main class="mama">
            <p class="p">首頁>消息/介紹>所有消息</p>
            <section>
                <h1>所有消息</h1>
                <div class="content" id="block_10">
                    <!-- <div class="left">
                        <p>2022年2月1號</p>
                        <h3>《怪哩怪汽》未來計畫揭露，第二年內容公布！</h3>
                        <p>即將發佈「全新VR賽道」和全新《發現之旅》，還有更多值得期待的內容。</p>
                        <a href="./news_in.html">
                            <p class="pp">
                                <閱讀更多>
                            </p>
                        </a>
                    </div>
                    <img src="../image/intro/1010.jpg" class="fir1" alt="slide4"> -->
                </div>
            </section>
        </main>


        <div id="content">
            <div id="block_1">

                <div class="search-form">
                    <div style="display:flex;" class="searsear">
                        <h3>文章搜尋：</h3>
                        <input id="search-input" onkeyup="find()" name="search-input" type="text" placeholder="關鍵字搜尋" style="outline: none;" />
                        <style id="m-search"></style>
                    </div>
                </div>

                <div class="buttons">
                    <button id="bbbn" class="btn old bbbn" onclick="sort()" >按時間排序由舊至新</button>
                    <button id="bbbn2" class="btn old bbbn2" onclick="sort2()">按時間排序由新至舊</button>
                </div>

                <div id="block_9"></div>

            </div>
        </div>

        <section class="section_news">
            <button id="bnbn">沒有更多內容了</button>
        </section>


    </div>

    <div class="upup">
        <i class="fas fa-arrow-circle-up totop"></i>
    </div>


    @@include('./footer.html')

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/aos/3.0.0-beta.6/aos.js"></script>
    <script>AOS.init();</script>
    <script src="../js/vendor/slick-1.8.1/slick/slick.min.js"></script>
    <script src="../js/vendor/slick-1.8.1/slick/slick.js"></script>
    <script src="../js/news/news.js"></script>  


    <script>
        function find() {
            // 綁定input標籤的變數
            let findvalue = document.getElementById('search-input').value
            $.ajax({
                method: "POST",
                url: "../php/news/callnews1.php",
                // php 跟 ajax交流
                data: {
                    find: findvalue,
                },
                dataType: "json",
                success: function (response) {
                    //更新html內容(透過jQuery跑迴圈取值)
                    let block_9 = document.getElementById("block_9");
                    // 先清空資料
                    block_9.innerHTML = "";
                    $.each(response, function (index, row) {
                        let str = ` 
                        <div class="sort" >
                            <div class="wrap" >
                                    <img src="../image/intro/${row.AIMG}" class="sec" alt="slide4">
                                <div class="name" >
                                        <p class="p">${row.ADATE}</p>
                                        <h3>${row.TITLE}</h3>
                                        <p class="p">${row.CONTENT}</p>
                                        <p >閱讀更多></p>   
                                </div>
                            </div>
                        </div>
                    `;
                    block_9.insertAdjacentHTML("beforeend" ,str);
                    });
                },
                error: function (exception) {
                    alert("發生錯誤: " + exception.status);
                }
            });
        }
    </script>
    

    <script>
        function parseCookie(item) {
            console.log(item.childNodes[1].childNodes[3].childNodes[3].innerText);
            let title = item.childNodes[1].childNodes[3].childNodes[3].innerText;
            sessionStorage.setItem('title', title);
            location.href="./news_in.html";
        }



    </script>

</body>

</html>